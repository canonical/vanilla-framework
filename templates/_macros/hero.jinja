{% from "_macros/cta/cta-block.jinja" import cta_block %}
{% from "_macros/image-container.jinja" import image_container %}

# Params
# title_text: Hero title text (required)
# subtitle_text: Hero subtitle text
# is_full_width_on_tablet: whether image is in its own row on tablet.
#   If false, image will be in its own row (stacked below header/description)
# image_src: image source URL (required)
# image_alt: image alt text
# image_aspect_ratio: image aspect ratio (16/9, 3/2, 2/3, cinematic, square)
# image_full_cover: whether the image should span the full width of the bottom of the hero section
# image_hidden_breakpoints: list of breakpoints where the image should be hidden, e.g. ["large", "medium"] to only show on small screens
# cta_primary_text: primary CTA button text, shown in a primary-colored button. Leave blank to hide CTA block.
# cta_primary_url: primary CTA button URL
# cta_secondary_text: secondary CTA button text, shown as a link
# cta_secondary_url: secondary CTA button URL
# Slots
# description: slot for additional paragraph-style content below the title and subtitle

{% macro hero(
  title_text="",
  subtitle_text="",
  is_full_width_on_tablet = true,
  image_src = "",
  image_alt = "",
  image_aspect_ratio = "",
  image_highlighted = false,
  image_full_cover = false,
  image_hidden_breakpoints = [],
  cta_primary_text = "",
  cta_primary_url = "#",
  cta_secondary_text = "",
  cta_secondary_url = "#"
)-%}
  {% set has_subtitle = subtitle_text|trim|length > 0 %}
  {% set description_content = caller('description') %}
  {% set has_description = description_content|trim|length > 0 %}
  {% set has_specific_image_aspect_ratio = image_aspect_ratio|trim|length > 0 %}
  {% set has_cta = cta_primary_text|trim|length > 0 %}

  {% macro _hero_title_block() -%}
    <h1 class="{% if image_full_cover %}u-no-margin--bottom{% endif %}">
      {{ title_text }}
    </h1>
  {% endmacro %}

  {% macro _hero_subtitle_block() -%}
    {% if has_subtitle %}
      <h2>
        {{ subtitle_text }}
      </h2>
    {% endif %}
  {% endmacro %}

  {% macro _hero_cta_block() -%}
    {% if has_cta %}
      {{ cta_block(
        primary_text=cta_primary_text,
        primary_url=cta_primary_url,
        secondary_text=cta_secondary_text,
        secondary_url=cta_secondary_url
      ) }}
    {% endif %}
  {% endmacro %}

  {% macro _hero_description_block() -%}
    {% if has_description %}
      <div class="p-section--shallow">
        {{ description_content }}
      </div>
    {% endif %}
  {% endmacro %}

  {% macro _hero_image() -%}
    <div class="{% for breakpoint in image_hidden_breakpoints %}u-hide--{{ breakpoint }} {% endfor %}">
      {{ image_container(image_src, alt=image_alt, aspect_ratio=image_aspect_ratio, is_highlighted=image_highlighted, is_cover=True) }}
    </div>
  {% endmacro %}

  <section class="p-section--hero">
    <div class="{% if is_full_width_on_tablet %}row--50-50-on-large{% else %}row--50-50{% endif %}">
      <div class="col">
        {% if image_full_cover %}
          {{ _hero_title_block() }}
        {% else %}
          <div class="p-section--shallow">
            {{ _hero_title_block() }}
            {{ _hero_subtitle_block() }}
          </div>
          {{ _hero_description_block() }}
          {{ _hero_cta_block() }}
        {% endif %}
      </div>
      <div class="col">
        {% if image_full_cover %}
          {{ _hero_subtitle_block() }}
          {{ _hero_description_block() }}
          {{ _hero_cta_block() }}
        {% else %}
          {{ _hero_image() }}
        {% endif %}
      </div>
      {% if image_full_cover %}
        {{ _hero_image() }}
      {% endif %}
    </div>
  </section>
{% endmacro %}
