@import 'settings';

$color-snippet-heading-bg: rgba($color-x-dark, 0.08);

@mixin vf-p-code-snippet {
  .p-code-snippet {
    margin-bottom: $spv-outer--scaleable;

    .p-code-snippet__block,
    .p-code-snippet__block--icon,
    .p-code-snippet__block--numbered {
      margin: 0;

      &.is-wrapped {
        white-space: pre-wrap;
      }
    }

    .p-code-snippet__block--icon {
      @extend %leading-linux-prompt-icon;

      padding-left: #{$sph-inner + map-get($icon-sizes, default) + $sph-inner--small};
      position: relative;

      &::before {
        @if ($increase-font-size-on-larger-screens) {
          // stylelint-disable-next-line max-nesting-depth
          @media (min-width: $breakpoint-x-large) {
            top: #{$spv-inner--x-small--scaleable + 0.5 * (map-get($line-heights, default-text) * $font-size-ratio--largescreen - map-get($icon-sizes, default))};
          }
        }
      }

      &.is-windows-prompt::before {
        @include vf-icon-chevron($color-mid-dark);

        transform: rotate(270deg);
      }

      &.is-url::before {
        @include vf-icon-get-link($color-mid-dark);
      }
    }

    .p-code-snippet__block--numbered {
      counter-reset: line-numbering;
    }

    .p-code-snippet__line {
      @extend %code-numbered-line;
    }

    .p-code-snippet__header {
      align-items: center;
      background-color: $color-code-heading-background;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      padding: $spv-inner--x-small--scaleable $sph-inner;
    }

    .p-code-snippet__title {
      @extend %vf-heading-5;

      margin-bottom: 0;
      padding-top: 0;
    }

    .p-code-snippet__dropdown {
      background-color: $color-transparent;
      border-color: $color-transparent;
      color: $color-dark;

      // taken from the .u-table-cell-padding-overlap utility
      margin-bottom: -#{$table-cell-vertical-padding} !important;
      margin-top: calc(-#{$table-cell-vertical-padding} - 1px) !important;
      min-width: min-content;

      // taken from the .is-dense button modifier
      padding-bottom: calc(#{$spv-nudge - $sp-unit * 0.5} - 1px);
      padding-top: calc(#{$spv-nudge - $sp-unit * 0.5} - 1px);

      &:not(:last-child) {
        border-right: 1px solid $colors--light-theme--border-default;
      }
    }

    .p-code-snippet__dropdowns {
      display: flex;
      flex-shrink: 0;
      margin-left: $sph-inner--small;
    }

    .p-code-snippet__dropdowns.is-full-width {
      border-top: 1px solid $colors--light-theme--border-default;
      flex: 1 1 100%;
      justify-content: flex-end;
      margin: calc(#{$sph-inner--small + $spv-nudge - $sp-unit * 0.5}) 0 0 0;
      padding-top: $sph-inner--small;

      .p-code-snippet__dropdown {
        width: min-content;
      }
    }
  }
}
